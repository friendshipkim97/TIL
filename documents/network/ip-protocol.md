# Network

### **네트워크 계층의 역할**

네트워크 계층의 기본 기능은 송수신 호스트 사이의 패킷 전달 경로를 선택하는 **라우팅**이다. 네트워크의 구성 형태에 대한 정보는 **라우팅 테이블**에 보관된다.

### **라우팅이란?**

송수신 호스트 사이의 패킷 전달 경로를 선택하는 과정

### **네트워크 계층의 또다른 기능(라우팅 제외)**

**혼잡 제어**: 네트워크 특정 지역에 트래픽이 몰리는 현상을 다룸

- 네트워크에 존재하는 전송 패킷의 수가 많아질수록 네트워크의 성능은 자연스럽게 감소한다. 이러한 현상을 **혼잡**이라고 하고, 혼잡 문제를 해결하기 위한 방안을 **혼잡 제어**라고 한다.

**패킷의 분할과 병합**: 라우터 사이의 패킷 중개 과정에서 다룸

- 분할이란? 큰 데이터를 여러 패킷으로 나누는 과정
- 병합이란? 목적지에서 분할된 패킷을 다시 모으는 과정

### **HELLO/ECHO 패킷**

라우터의 초기화 과정에서 가장 먼저 할 일은 이웃 라우터의 경로 정보를 파악하는 것. 각 라우터는 이웃에 연결된 라우터에 **초기화**를 위한 **HELLO**패킷을 전송해 경로 정보를 얻는다. 또한, 라우터 사이의 전송 지연 시간을 측정하기 위해서는 **ECHO** 패킷을 전송하는데, ECHO 패킷을 수신한 호스트는 송신 호스트에 **즉각 회신**하도록 설계된다.


### **트래픽 성형**
**트래픽 성형**이란 송신 호스트가 전송하는 패킷의 발생 빈도가 네트워크에서 예측할 수 있는 전송률로 이루어지게 하는 기능이다. 송신 호스트가 사전에 약속한 트래픽보다 과도한 양의 패킷을 전송하면 네트워크에서 적절히 **통제**해야 한다. 트래픽 성형과 관련된 알고리즘 중에서 유명한 것은 **리키 버킷**이다. 송신 호스트와 네트워크 사이에는 송신 호스트가 협상에서 제시한 전송 특성을 반영하는 적절한 크기의 깔때기가 위치하는데, 깔때기의 출구 크기는 협상 결과를 의미하므로 크기가 고정되어 있따. 따라서, **송신 호스트가 협상 값보다 많은 양의 패킷을 전송해도 깔때기 크기 이상의 패킷이 네트워크에 유입될 수 없다.** 

### **ECN 패킷**

**ECN패킷**을 이용해 혼잡 문제를 해결할 수 있다. **ECN(Explicit Congestion Notification)패킷**을 수신한 송신 호스트는 데이터 패킷이 전송되는 경로에서 혼잡이 발생할 가능성을 인지하고 전송 패킷의 양을 줄여야 한다. 즉, 출력 선로의 사용 정도가 한계치를 초과하면 주의 표시를 해둔다. 

### **내부 라우팅 용도**

- **거리 벡터 라우팅 프로토콜**

    **거리 벡터 라우팅 프로토콜**은 라우터가 자신과 직접 연결된 이웃 라우터와 라우팅 정보를 교환하는 방식이다. 이때, 정보를 교환하는 라우터는 거리 벡터 라우팅 프로토콜을 사용하는 호스트나 라우터들이다. 교환 정보로는 각각의 라우터에서 전체 네트워크에 소속되는 개별 네트워크까지 패킷을 전송하는 데 걸리는 거리 정보이다. 거리 벡터 알고리즘을 구현하려면 라우터가 링크 벡터, 거리 벡터, 다음 홉 벡터라는 세 가지 정보를 관리해야 한다. **RIP 프로토콜**은 거리 벡터 방식을 사용하는 내부 라우팅 프로토콜 중에서 가장 간단하게 구현된 것이다. 

- **링크 상태 라우팅 프로토콜**

    **링크 상태 라우팅 프로토콜**은 라우터 간의 정보 교환 원리가 거리 벡터 방식과 반대이다. 개별 라우터가 이웃 라우터까지의 거리 정보를 구한 후, 이를 네트워크에 연결된 모든 라우터에 통보한다. 거리 벡터 라우팅 프로토콜의 단점인 각 라우터가 상당한 양의 정보 전송을 요구받고, 링크 상태가 많이 변하면 동작 과정에서 시간이 많이 소요될 수 있다는 점을 극복한 것이 **링크 상태 라우팅 프로토콜**이다. 링크 상태 라우팅 프로토콜의 예시로는 TCP/IP 기반의 인터넷에서 사용하는 **OSPF**가 있다.

### **외부 라우팅 용도**

- **경로 벡터 프로토콜**

    **경로 벡터 프로토콜**은 경로에 관한 거리 정보 값이 필요 없는 방식이다. **단순히 해당 라우터에서 어느 네트워크가 연결 가능한지에 대한 정보만 제공한다.** 이는 근거리의 경로 정보를 관리하는 내부 라우팅 프로토콜이 효율의 문제를 고려하지만, 원거리의 경로 정보를 관리하는 외부 라우팅 프로토콜은 경로의 존재 유무에 초점을 맞추기 때문이다. **BGP**는 외부 라우팅 프로토콜의 예시로, 인터넷에서 많이 사용된다.


### **IP 프로토콜**

인터넷 환경에서 네트워크 계층의 데이터 전송 프로토콜로 이용되는 IP는 호스트 주소 표기, 패킷 분할에 관한 기능을 지원하지만, 단대단 형식의 **오류 제어**나 **흐름 제어** 기능은 제공하지 않는다. IP 프로토콜에서 라우터 간의 패킷을 중개할 때는 **Best Effort**라는 원칙에 따라 전송하는데, 이 방식은 전송 패킷이 수신 호스트에 100% 도착하는 것을 보장하지 않는다. 따라서 IP프로토콜에서 제공하지 않는 전송 오류 문제를 상위 계층에서 고려해야 한다.

### **IP 패킷의 분할**

다양한 유형의 네트워크를 통해 패킷을 중개하려면, IP 포로토콜이 패킷을 각 네트워크에서 처리하기 편한 크기로 분할해야 한다. 데이터 링크 계층 프로토콜의 프레임은 크기가 **프로토콜 마다 다르다.** 따라서, 상위 계층에서 내려온 데이터를 계층 2의 프레임 틀에 담을 수 있도록 IP 프로토콜에서 분할 과정을 거친 후에 전송하고, 수신 측에서는 이를 다시 합치는 병합 작업을 수행한다. IP 프로토콜의 분할 기능은 전송 경로에 위치한 **라우터**에 의해 수행된다.

### **DHCP 프로토콜**

DHCP는 Dynamic Host Configuration Protocol의 약자로, 동적 호스트 구성 프로토콜이다. 특정 네트워크를 관리하는 네트워크 관리자는 개별 호스트들에 수동으로 고정 IP 주소를 할당할 수 있지만, IP 주소가 부족할 경우 **DHCP**를 사용해 자동으로 할당한다. 자동으로 할당 가능한 IP주소는 DHCP 서버가 관리하는 풀에 저장되어 관리되며, 클라이언트로부터 IP 주소 요청이 오면 풀에서 하나의 IP주소를 할당한다. 이후 사용이 끝나면 다시 IP주소 풀로 반환되어 다른 호스트가 사용할 수 있다. 





